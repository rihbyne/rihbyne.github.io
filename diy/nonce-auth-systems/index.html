<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>swlogs - Cryptographic Nonce in Authenticated Systems</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href='https://fonts.googleapis.com/css?family=Gentium+Book+Basic|Merriweather:400,300' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://rihenperry.github.io/theme/css/cid.css">
        <link href="https://rihenperry.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="swlogs Atom Feed" />
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

            <div class="container">

<style rel="text/css">
 body p {
    text-align: justify
 }

 .site-logo {
    float: left;
  }
.container .blog-header h1 , .container .blog-header p {
}
.container .blog-header h1 {

    display: inline-block;
}
.site-logo img {
    width: 100%;
    max-width: 110px;
    height: auto;
margin-right:25px;
}

 .blog-header nav a {
    text-decoration:none;
     color: blue;
 }

 .blog-footer .nav a {
     text-decoration: none;
     color: blue;
 }

 .blog-footer .nav .dots {
     font-weight: bold;
 }
</style>
<header class="blog-header">
  <div class="header-container" style="height: auto">
    <div class="site-logo" >
       <img  src="https://rihenperry.github.io/images/android-chrome-512x512.png">
    </div>
    <div>
      <h1>
       <a href="https://rihenperry.github.io">swlogs</a>
      </h1>
      <p> recording happenings around </p>
    </div>
  </div>
</header>
    <h1>Cryptographic Nonce in Authenticated Systems</h1>
    

    <h2 id="what-is-nonce">What is Nonce ?</h2>
<p>Cryptographic Nonce is a random or arbitrary number which is used only once. The number involves timestamping and to avoid number predicting in future requests, the number generated should be such that it should be probabilistically impossible to get the same number repeated again. It is used as a means in security mechanisms to ensure that previous request cannot be used in subsequent requests. This concept is used to avoid attacks where in a network the data exchanged between two servers is repeated and delayed by a malicious user intercepting the API calls between NodeJS and PHP server. That’s why they are called as playback attacks or replay attacks.</p>
<h2 id="why-use-it">Why use it ?</h2>
<ul>
<li>If implemented, Nonce will avoid the playback or replay attacks from happening especially if the APIs are served with no SSL encryption over HTTP. </li>
<li>Now, this may happen if originator or a fraudster retransmits the entire signed APIs as part of DOS(Denial of Service) attack. The way to avoid replay/playback attacks is to employ token based sessions. </li>
<li>The technique is commonly used in finance firms.These are one-time tokens. The one-time token is delivered to the recipient when the recipient request one from the server. The recipient performs math transformation on its end with the data and sends the result and also the data to the server. If it matches then the call is proved to be authentic.</li>
<li>Nonce is one of the technique in practice to prevent replay attacks which is like ‘request -&gt; serve request -&gt; forget request’ assuming a suitable time frame.</li>
</ul>
<p><em>Note: Magna-* isolated services of application</em></p>
<h2 id="nonce-in-practice-between-magna-nodejs-magna-php-and-magna-notifier">Nonce in Practice between Magna-NodeJS, Magna-PHP and Magna-Notifier:</h2>
<p>Nonce implementations vary based on the architecture of the systems. Here is how I implemented Nonce at
work.</p>
<p><img alt="block_diagram" src="https://rihenperry.github.io/diy/nonce-auth-systems/crypt_nonce_flow.png"></p>
<ul>
<li>To apply nonce in our systems, we have to keep machines in sync. </li>
<li>The time sync can be maintained using NTP on each machine. NodeJS should be given the priority of providing precision timestamp to PHP server and the notifier.</li>
<li>It’s an interesting puzzle and is certainly plausible. Without time synchronization between servers, we will not see the benefactors of Nonce. </li>
</ul>
<h2 id="nonce-generator-and-verifier-pseudocode">Nonce generator and verifier pseudocode:</h2>
<p>Our endpoints send nonce along with a digital signature &amp; a public key. 
With Nonce support enabled in the settings of each service, the Digital Signature will change with every request even if the request parameters are same for the API. This is because, the authentic server has to include request headers - nonce and timestamp at which the nonce was created. The Digital Signature  will have the timestamp appended to the tail of the text before the digest is calculated from the text. This will cause human orchestrated API calls painfully difficult to crack because the person has to know the secret used to generate the subsequent nonce. Only trusted machines know the secret to nonce generation at that particular
time.</p>
<p><img src="../../images/diy/nonce_crypt_activity_flow.png" width="1000" height="750"></p>


<footer class="blog-footer">

    <ul class="nav">
                    <li><a href="https://rihenperry.github.io/blog">posts</a></li>
                    <li class="dots">.</li>
                    <li><a href="https://rihenperry.github.io/diy">solos</a></li>
                    <li class="dots">.</li>
                    <li><a href="https://rihenperry.github.io/downloadables/resume.pdf">resume</a></li>
                    <li class="dots">.</li>
                    <li><a href="https://rihenperry.github.io/https://goodreads.com/rihanpereira">reading</a></li>
                    <li class="dots">.</li>
    </ul>

    <p class="disclaimer">
        Rihan &copy; 2019. Contents are <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/us/">cc by-nc-sa</a>. All opinions are of my own.
    </p>
</footer>
            </div>
    </body>
</html>